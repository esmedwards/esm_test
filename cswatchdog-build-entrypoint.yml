trigger: none

# resources:
#   repositories:
#     - repository: DevOps
#       type: git
#       name: 'Viewfinder Common/DevOps'
#       ref: refs/heads/develop

variables:
  solution: '**/*.sln'
  buildPlatform: 'Any CPU'
  buildConfiguration: 'Release'
  CERT_THUMBPRINT: '3b7b512bc32e8b50265d40659e1218902e8a1cc1'

jobs: 
- job: Invoke_CS_Watchdog
  pool: server
  continueOnError: true
  steps:
  - task: InvokeRESTAPI@1
    inputs:
      connectionType: 'connectedServiceName'
      serviceConnection: 'CS Watchdog Approval Flow Connection'
      method: 'POST'
      waitForCompletion: 'true'
  - task: InvokeRESTAPI@1
    displayName: 'Get Approval'
    inputs:
      connectionType: 'connectedServiceName'
      serviceConnection: 'CS Watchdog Approval Flow Connection'
      method: 'POST'
      headers: '{Content-Type:application/json, PlanUrl: $(system.CollectionUri), ProjectId: $(system.TeamProjectId), HubName: $(system.HostType), PlanId: $(system.PlanId), JobId: $(system.JobId), TimelineId: $(system.TimelineId), TaskInstanceId: $(system.TaskInstanceId), AuthToken: $(system.AccessToken)}' 
      # body: |
      #    {
      #       "buildNumber": "$(build.buildId)",
      #       "isMultiBranch": "true",
      #       "branchName": "$(build.sourceBranchName)"
      #    }
      # urlSuffix: "workflows/af7c40aaa6d444ac807b3fb2bf60be8a/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=4g28FDXHg0gUsEeTQgMuf9Hw3jyWwkVEgL80TWU4Xos"
      waitForCompletion: 'true'
      #successCriteria: # Optional
